# Windows 10

## boot

1. 现在安装 → 我没有产品密钥 → Windows 10 专业版 → 自定义：仅安装Windows（高级） → 选择目标驱动器 → 格式化 → 新建
2. 我没有Internet连接
3. 继续执行有线设置
4. 使用脱机账户 → 不填写密码
5. 运行 → `control userpasswords2` → 属性 → 要使用本计算机，用户必须输入用户名和密码(Off)

## System environment 

### Get Windows default environments

```sh
SET
```

```
# BaseDirs
ALLUSERSPROFILE=C:\ProgramData
APPDATA=C:\Users\User\AppData\Roaming
CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
CommonProgramFiles=C:\Program Files\Common Files
DriverData=C:\Windows\System32\Drivers\DriverData
HOMEDRIVE=C:
HOMEPATH=\Users\User
LOCALAPPDATA=C:\Users\User\AppData\Local
ProgramData=C:\ProgramData
ProgramFiles(x86)=C:\Program Files (x86)
ProgramFiles=C:\Program Files
PUBLIC=C:\Users\Public
SystemDrive=C:
SystemRoot=C:\Windows
TEMP=%SystemRoot%\TEMP # TEMP=C:\Users\User\AppData\Local\Temp
TMP=%SystemRoot%\TEMP # TMP=C:\Users\User\AppData\Local\Temp
USERNAME=User
USERPROFILE=C:\Users\User
windir=%SystemRoot%

# Other
ComSpec=C:\Windows\system32\cmd.exe
FPS_BROWSER_APP_PROFILE_STRING=Internet Explorer
FPS_BROWSER_USER_PROFILE_STRING=Default
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC

# PATH
Path=C:\Windows;C:\Windows\system32;C:\Windows\System32\OpenSSH;C:\Windows\system32\wbem;C:\Windows\System32\WindowsPowerShell\v1.0
```

### Add into System Environment

```
USERHOME=<user_path>
SCOOP_GLOBAL=<user_path>\Usr\Scoop
```

### Add into top of System PATH

```
C:\Users\User\Usr\Git\Shell\_windows\Patch;
```

### Add into User Environment

```
EDITOR=nvim
## CUDA
CUDNN=C:\Program Files\NVIDIA\CUDNN\v9.17\bin\12.9;C:\Program Files\NVIDIA\CUDNN\v9.17\include\12.9;C:\Program Files\NVIDIA\CUDNN\v9.17\lib\12.9\x64
## Hugging Face
# HF_DATASET_ROOT=C:\Users\User\Usr\Model\huggingface\dataset
# HF_MODEL_ROOT=C:\Users\User\Usr\Model\huggingface\model
# HF_ENDPOINT=https://hf-mirror.com
# HF_MIRROR=https://huggingface.co
HF_MIRROR=https://hf-mirror.com
HF_HUB_ENABLE_HF_TRANSFER=1
## Lib
CARGO_HOME=C:\Users\User\.cargo
CARGO_TARGET_DIR=C:\Users\User\.cargo\tmp
GOPATH=C:\Users\User\.go
GOROOT=C:\Users\User\Scoop\apps\go122\current
# GOROOT=C:\Users\User\Usr\Lib\go1.20.1
UV_PYTHON=3.12
# UV_CACHE_DIR=C:\Users\User\Usr\Data\uv_cache
JAVA_HOME=C:\Users\User\Scoop\apps\openjdk22\current
LUA_PATH=C:\Users\User\Usr\Lib\lua-5.4.6;C:\Users\User\AppData\Roaming\luarocks\share\lua\5.4\?.lua;C:\Users\User\AppData\Roaming\luarocks\share\lua\5.4\?\init.lua
LUA_CPATH=C:\Users\User\Usr\Lib\lua-5.4.6\src;C:\Users\User\AppData\Roaming\luarocks\lib\lua\5.4\?.dll
PIPX_HOME=C:\Users\User\.pipx
PNPM_HOME=C:\Users\User\.pnpm
## Bin
LIBCLANG_PATH=C:\Users\User\Scoop\apps\llvm\current\bin
LLVM_LIB_DIR=C:\Users\User\Scoop\apps\llvm\current\lib
SCOOP=C:\Users\User\Scoop
# LUA_DEV=C:\Users\User\apps\lua-for-windows\current
NVM_HOME=C:\Users\User\Scoop\apps\nvm\current
NVM_SYMLINK=C:\Users\User\Scoop\persist\nvm\nodejs\nodejs
## Opt
MAGICK_CODER_MODULE_PATH=C:\Users\User\Scoop\apps\imagemagick\current\modules\coders
MAGICK_HOME=C:\Users\User\Scoop\apps\imagemagick\current
OLLAMA_HOST=localhost
OLLAMA_ORIGINS=*
TESSDATA_PREFIX=C:\Users\User\Scoop\apps\tesseract-languages\current
## Other
DOTFILES_DIR=C:\Users\User\Usr\Git\dotfiles
PEGASUS_HOME=C:\Users\User\Scoop\apps\pegasus\current
```

### Add into User PATH (ignore the scoop add)

```
C:\Users\User\.local\bin;
## Lib
C:\Users\User\.cargo\bin;
C:\Users\User\.cargo\tmp\release\deps;
C:\Users\User\.rustup\toolchains\stable-x86_64-pc-windows-msvc\bin;
C:\Users\User\.go\bin;
C:\Users\User\.pipx\bin;
C:\Users\User\.pnpm;
C:\Users\User\AppData\Local\Yarn\bin;
C:\Users\User\Usr\Lib\lua-5.4.6;
C:\Users\User\Usr\Lib\lua-5.4.6\bin;
C:\Users\User\AppData\Roaming\luarocks\bin;
C:\Users\User\Usr\Lib\rbenv\rbenv\bin;
C:\Users\User\Usr\Lib\rbenv\shims;
# C:\Users\User\.pyenv\pyenv-win\bin;
# C:\Users\User\.pyenv\pyenv-win\shims;
## Opt
C:\Program Files\Ethea\SVGShellExtensions;
C:\Program Files\GPSoftware\Directory Opus;
C:\Program Files\LinkShellExtension\32;
C:\Program Files\BraveSoftware\Brave-Browser\Application;
C:\Program Files\Sublime Text;
## Shell
C:\Users\User\Usr\Git\Shell\_windows;
C:\Users\User\Usr\Git\Shell\_windows\SendTo;
C:\Users\User\Usr\Git\Shell\_windows\FromClipboard;
C:\Users\User\Usr\Git\Shell\bin;
C:\Users\User\Usr\Git\Shell\opt;
## Standby
C:\Users\User\Usr\Opt\WezTerm;
## Patch
C:\Users\User\Usr\Opt\cmder_mini;
C:\Users\User\Usr\Srv\Kiwix-Server;
C:\Users\User\Scoop\apps\detect-it-easy\current;
C:\Users\User\Scoop\apps\sioyek\current;
# C:\Users\User\Scoop\apps\video-compare\current;
## Cache
# C:\Program Files (x86)\Aspell-0.60\bin;
# C:\Users\User\Scoop\apps\yarn\current\bin;
# C:\Users\User\Scoop\apps\yarn\current\global\node_modules\.bin;
```

### Reset Windows certificate store

```sh
certutil -generateSSTFromWU roots.sst
certutil -addstore -f root roots.sst
del roots.sst
```

## config (Cache) { #config }

- `Win+Q`
	- 搜索权限和历史记录 → (All Off)
	- Windows Search设置 → 高级搜索索引器设置 → 经典 → 在此自定义搜索位置 → 修改 → 包含的位置/用户 Off → 确定
- 鼠标
	- 鼠标设置 → 其他鼠标选项 → 指针 → Grey Tango
	- 自定义 → 文本选择 → 浏览 → `cursor_white/Text.cur` → 应用
- SMB
	- 启用或关闭Windows功能 → SMB1.0/CIFS文件共享支持(On) → SMB直通(On)
	- 网络和共享中心 → 高级共享设置 → 专用 → 启用网络发现(On) → 启用网络连接设备的自动设置(On) → 启用文件和打印机共享(On)
	- 计算机管理 → 本地用户和组 → 用户 → 右键 → 新用户 → 用户名() → 用户不能更改密码(On) → 密码永不过期(On) → 新建
	- 文件夹 → 右键 → 属性 → 共享 → 共享 → 选择要与其共享的用户 ... 权限级别(读取/写入) → 共享 → 完成
- 查询本机IP
	- CMD → `ipconfig | findstr /i "ipv4"`
	- 网络状态 → 更改适配器选项 → 以太网 → 属性 → Internet协议版本4 → IPv4
- 添加网络位置
	- 此电脑 → 右键 → 添加一个网络位置 → 下一页 → 选择自定义网络位置 → 查看示例 ... 用户名() → 下一步 ... 保存密码(On) → 登录 → 完成
- 新建防火墙规则
	- 管理Windows防火墙规则 → 创建新规则 → 新增空白规则 ... 此程序 → 浏览名称 → 方向 → 出站
- 资源管理器
	- 查看 → 选项 → 常规 → 打开文件资源管理器时打开(此电脑) → 在"快速访问"中显示常用文件夹(Off)
	- ... 查看 → 显示隐藏的文件、文件夹和驱动器 (On) → 隐藏已知文件类型的扩展名 (Off)
- 自动播放CD或其他媒体
	- 可移动驱动器 → 不执行操作
- 关闭Windows键热键
	- 编辑组策略 → 用户配置 → 管理模板 → Windows组件 → 文件资源管理器 → 关闭Windows键热键 → 右键 → 编辑 → 已启用 → 确定
- 键盘
	- Windows
		- 编辑语言和键盘选项
			- 拼写、键入和键盘设置 → 全部关闭
			- 添加语言 → 英语(美国)
			- 添加语言 → 中文(简体，中国)/选项 → 微软拼音 → 删除
		- 高级键盘设置
			- 语言栏选项 → 语言栏/语言栏 隐藏 → (可选)高级键设置
				- 在输入语言之间 → 更改按键顺序 → (无)
				- 切换到英语(美国) - 美式键盘 → 更改按键顺序 → (无)
				- 切换到中国(简体,中国) - 小狼毫 → 更改按键顺序 → Ctrl+Shift+1
				- 中文(简体)输入法 - 输入法/非输入发切换 → Ctrl+Shift+F12
			- 替代默认输入法 → 英语(美国) - 美式键盘 → 允许我为每个应用窗口使用不同的输入法 Off
	- KBLAutoSwith → 设置
		- 基础设置1 → 输入法切换设置
			- 自动切换 → 禁止
			- 默认输入法 → 英文
		- 基础设置2 → 特殊热键 → 右Shift → 切换中英文输入法
	- Rime
		- 迁移: 复制用户资料夹到新目录 → 小狼毫 安装选项 → 新目录 → 小狼毫 重新部署 → 小狼毫算法服务
		- 小狼毫安装选项 → 用户文件夹 → 使用默认默认位置 → 修改文件夹
		- 小狼毫重新部署
			- 小狼毫输入法设定 → 检查配置
		- 崩溃时运行小狼毫算法服务
- 声音
	- 声音 → 声音控制面板 → 声音 → 声音方案 → 无声
- Game bar
	- 游戏 → Game Bar (Off) → 允许控制器打开Game Bar (Off)
- 更改DNS服务器
	- 查看网络连接 → 以太网 → 属性 → 网络 → Internet协议版本4 → 属性 → 自动获得DNS服务器地址
	- 命令提示符 → `ipconfig /flushdns`
- 打印机
	- 属性 → 共享 → 共享这台打印机 (On) → 在客户端计算机上呈现打印作业 (On)


## reference

- #blog [Windows GUI: Good, Bad and Pretty Ugly (Ranked)](https://creolened.com/windows-gui-good-bad-and-pretty-ugly-ranked/)
- #guide [video-compare - Practical tips](https://github.com/pixop/video-compare?tab=readme-ov-file#practical-tips)

## cross-reference

### mark

- [revios.md](/os/windows10/revios.md)

### cache

- [wsl.md](/os/windows10/wsl.md)

## troubleshoot

- [Fix problems with Opus OGG files in Windows 10](https://www.youtube.com/watch?v=y6wMvTldfQo)

## resource

### cache

- [AtlasOS](https://github.com/Atlas-OS/Atlas)
- [Hiren’s BootCD PE](https://hirensbootcd.org)
